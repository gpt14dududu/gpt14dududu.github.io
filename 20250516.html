<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•æˆèªé–ƒå¡ (å¤šæ¨¡å¼æ›´æ–°)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f4f8;
            color: #333;
        }
        .flashcard-container {
            perspective: 1000px;
            width: 90%;
            max-width: 500px;
            min-height: 380px; /* ç•¥å¾®å¢åŠ æœ€å°é«˜åº¦ */
            margin: 15px auto; /* èª¿æ•´é‚Šè· */
        }
        .flashcard {
            width: 100%;
            height: 100%;
            min-height: 350px; /* å¡ç‰‡æœ€å°é«˜åº¦ */
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        .flashcard.is-flipped {
            transform: rotateY(180deg);
        }
        .flashcard-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 15px; /* çµ±ä¸€å…§é‚Šè· */
            box-sizing: border-box;
            border-radius: 16px;
            text-align: center;
            overflow-y: auto;
        }
        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .flashcard-back {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            color: #333;
            transform: rotateY(180deg);
        }
        .idiom-text {
            font-size: 2rem; /* èª¿æ•´å¤§å°ä»¥é©æ‡‰ç©ºé–“ */
            font-weight: 700;
            margin-bottom: 3px;
        }
        .bopomofo-text {
            font-size: 0.9rem; /* èª¿æ•´å¤§å° */
            color: #e0e0e0;
            margin-bottom: 8px;
        }
        /* ç”¨æ–¼é¸æ“‡é¡Œæ¨¡å¼ä¸‹ï¼Œæˆèªä½œç‚ºé¡Œç›®æ™‚çš„æ¨£å¼ */
        .flashcard-front .question-idiom-text {
            font-size: 1.8rem;
            font-weight: 700;
            color: #fff; /* ç¢ºä¿åœ¨æ­£é¢èƒŒæ™¯ä¸Šå¯è¦‹ */
            margin-bottom: 2px;
        }
        .flashcard-front .question-bopomofo-text {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-bottom: 5px;
        }
        .flashcard-back h3, .mcq-question-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #583c63;
            margin-bottom: 6px;
        }
         .flashcard-front .mcq-question-title {
            color: #f0f0f0;
            margin-top: 0;
            margin-bottom: 8px; /* å¢åŠ èˆ‡ä¸‹æ–¹å…§å®¹çš„é–“è· */
        }
        .flashcard-back p, .flashcard-front .mcq-question-text {
            font-size: 0.85rem; /* èª¿æ•´å…§æ–‡å¤§å° */
            line-height: 1.5;
            margin-bottom: 8px;
        }
        .flashcard-front .mcq-question-text {
             color: #ffffff;
             max-height: 90px;
             overflow-y: auto;
             margin-bottom: 10px; /* ç¢ºä¿èˆ‡é¸é …é–“æœ‰è¶³å¤ ç©ºé–“ */
        }

        .navigation-buttons, .mode-selector {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px; /* èª¿æ•´ä¸Šæ–¹é–“è· */
            margin-bottom: 10px;
            gap: 8px;
            flex-wrap: wrap;
        }
        .nav-button, .mode-button {
            background-color: #4a5568;
            color: white;
            padding: 8px 15px; /* çµ±ä¸€æŒ‰éˆ•å¤§å° */
            border: none;
            border-radius: 8px;
            font-size: 0.85rem; /* çµ±ä¸€å­—é«”å¤§å° */
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 3px 5px rgba(0,0,0,0.1);
        }
        .nav-button:hover, .mode-button:hover {
            background-color: #2d3748;
            transform: translateY(-1px);
        }
        .nav-button:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
            transform: translateY(0);
        }
        .mode-button.active {
            background-color: #667eea;
            font-weight: bold;
        }
        .card-counter {
            text-align: center;
            margin-top: 8px;
            font-size: 0.85rem;
            color: #4a5568;
        }
        .instructions {
            text-align: center;
            margin-bottom: 10px;
            color: #4a5568;
            font-size: 0.85rem;
        }

        .multiple-choice-options {
            margin-top: 10px; /* èª¿æ•´èˆ‡ä¸Šæ–¹å•é¡Œçš„é–“è· */
            display: flex;
            flex-direction: column;
            gap: 6px; /* é¸é …é–“è· */
            width: 100%;
            padding: 0 8px;
            box-sizing: border-box;
        }
        .choice-button {
            background-color: #718096;
            color: white;
            padding: 8px; /* é¸é …æŒ‰éˆ•å…§é‚Šè· */
            border: none;
            border-radius: 6px;
            font-size: 0.8rem; /* é¸é …æ–‡å­—å¤§å° */
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
            box-sizing: border-box;
            word-break: break-word; /* é˜²æ­¢æ–‡å­—éé•·æº¢å‡º */
        }
        .choice-button:hover {
            background-color: #4a5568;
        }
        .choice-button.correct {
            background-color: #48bb78;
        }
        .choice-button.incorrect {
            background-color: #f56565;
        }
        .feedback-message {
            margin-top: 8px;
            font-size: 0.85rem;
            font-weight: bold;
            min-height: 18px; /* èª¿æ•´é«˜åº¦ */
        }

        @media (max-width: 600px) {
            .flashcard-container {
                 min-height: 420px; /* æ‰‹æ©Ÿä¸Šç¢ºä¿è¶³å¤ é«˜åº¦ */
            }
            .idiom-text, .flashcard-front .question-idiom-text {
                font-size: 1.6rem;
            }
            .bopomofo-text, .flashcard-front .question-bopomofo-text {
                font-size: 0.8rem;
            }
            .flashcard-back h3, .mcq-question-title {
                font-size: 1rem;
            }
            .flashcard-back p, .flashcard-front .mcq-question-text {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body class="bg-slate-100 flex flex-col items-center justify-center min-h-screen p-3">

    <h1 class="text-2xl md:text-3xl font-bold text-gray-700 mb-4 text-center">äº’å‹•æˆèªé–ƒå¡</h1>
    <p class="instructions">é»æ“Šå¡ç‰‡ç¿»é¢ã€‚é¸æ“‡æ¨¡å¼é–‹å§‹å­¸ç¿’ï¼</p>

    <div class="mode-selector">
        <button id="mode-normal" class="mode-button active">æ­£å‘å­¸ç¿’</button>
        <button id="mode-reverse" class="mode-button">åå‘å­¸ç¿’</button>
        <button id="mode-mcq-meaning-to-idiom" class="mode-button">é¸æ“‡é¡Œ (çœ‹æ„æ€é¸æˆèª)</button>
        <button id="mode-mcq-idiom-to-meaning" class="mode-button">é¸æ“‡é¡Œ (çœ‹æˆèªé¸æ„æ€)</button>
    </div>

    <div id="flashcard-container" class="flashcard-container">
        <div id="flashcard" class="flashcard">
            <div class="flashcard-face flashcard-front">
                </div>
            <div class="flashcard-face flashcard-back">
                </div>
        </div>
    </div>
    <div id="feedback-message" class="feedback-message text-center"></div>

    <div id="card-counter" class="card-counter"></div>

    <div class="navigation-buttons">
        <button id="prev-button" class="nav-button">ä¸Šä¸€å¼µ</button>
        <button id="next-button" class="nav-button">ä¸‹ä¸€å¼µ</button>
    </div>

    <script>
        const idioms = [
            { idiom: "æ´—è€³æ­è½", pinyin: "xÇ Ä›r gÅng tÄ«ng", bopomofo: "ã„’ã„§Ë‡ ã„¦Ë‡ ã„ã„¨ã„¥ ã„Šã„§ã„¥", meaning: "æ¯”å–»å°ˆå¿ƒæ­æ•¬çš„è†è½ã€‚", example: "æœ‰ä½•é«˜è¦‹è«‹ç›´èªªç„¡å¦¨ï¼Œæˆ‘å€‘ä¸€å®šæ´—è€³æ­è½ã€‚" },
            { idiom: "è² èŠè«‹ç½ª", pinyin: "fÃ¹ jÄ«ng qÇng zuÃ¬", bopomofo: "ã„ˆã„¨Ë‹ ã„ã„§ã„¥ ã„‘ã„§ã„¥Ë‡ ã„—ã„¨ã„ŸË‹", meaning: "æ¯”å–»ä¸»å‹•å‘å°æ–¹æ‰¿èªéŒ¯èª¤ï¼Œè«‹æ±‚è²¬ç½°å’ŒåŸè«’ã€‚", example: "å°æ–¼ä»–è² èŠè«‹ç½ªï¼Œå‹‡æ–¼æ‚”æ”¹çš„ä½œæ³•ï¼Œæˆ‘æ·±æ„Ÿæ¬½ä½©ã€‚" },
            { idiom: "æŠ«èŠæ–¬æ£˜", pinyin: "pÄ« jÄ«ng zhÇn jÃ­", bopomofo: "ã„†ã„§ ã„ã„§ã„¥ ã„“ã„¢Ë‡ ã„ã„§ËŠ", meaning: "æ¯”å–»å…‹æœå›°é›£ï¼Œæƒé™¤éšœç¤™ã€‚", example: "ä»–ç™½æ‰‹èµ·å®¶ï¼Œå¤šå¹´ä¾†åœ¨å•†å ´ä¸ŠæŠ«èŠæ–¬æ£˜ï¼Œçµ‚æ–¼æœ‰äº†ä»Šæ—¥çš„æˆå°±ã€‚" },
            { idiom: "ç§»é¢¨æ˜“ä¿—", pinyin: "yÃ­ fÄ“ng yÃ¬ sÃº", bopomofo: "ã„§ËŠ ã„ˆã„¥ ã„§Ë‹ ã„™ã„¨ËŠ", meaning: "æ”¹å–„ä¸è‰¯çš„ç¤¾æœƒé¢¨æ°£å’Œç¿’ä¿—ã€‚", example: "å…¸é›…çš„éŸ³æ¨‚å…·æœ‰ç§»é¢¨æ˜“ä¿—çš„åŠŸæ•ˆï¼Œç•¶ç„¶å€¼å¾—å¤§åŠ›æ¨å»£ã€‚" },
            { idiom: "å’«å°ºå¤©æ¶¯", pinyin: "zhÇ chÇ tiÄn yÃ¡", bopomofo: "ã„“Ë‡ ã„”Ë‡ ã„Šã„§ã„¢ ã„§ã„šËŠ", meaning: "æ¯”å–»ç›¸è·é›–è¿‘ï¼Œå»æœ‰å¦‚ç›¸éš”å¤©æ¶¯ä¸€èˆ¬ï¼Œç„¡ç·£ç›¸è¦‹ã€‚", example: "æˆ‘å€‘é›–ç„¶æ˜¯é„°å±…ï¼Œå»å› å„å¿™å„çš„ï¼Œå¾ˆå°‘è¦‹é¢ï¼ŒçœŸå¯è¬‚å’«å°ºå¤©æ¶¯ã€‚" },
            { idiom: "ä¸€å¸†é¢¨é †", pinyin: "yÄ« fÄn fÄ“ng shÃ¹n", bopomofo: "ã„§ ã„ˆã„¢ ã„ˆã„¥ ã„•ã„¨ã„£Ë‹", meaning: "æ¯”å–»éå¸¸é †åˆ©ï¼Œæ¯«ç„¡é˜»ç¤™ã€‚", example: "å¼µå…ˆç”Ÿæœ‰è²´äººç›¸åŠ©ï¼Œäº‹æ¥­ä¸€å¸†é¢¨é †ã€‚" },
            { idiom: "é«˜ç»é çŸš", pinyin: "gÄo zhÄn yuÇn zhÇ”", bopomofo: "ã„ã„  ã„“ã„¢ ã„©ã„¢Ë‡ ã„“ã„¨Ë‡", meaning: "å½¢å®¹è¦‹è­˜é å¤§ï¼Œçœ‹å¾—é•·é ã€‚", example: "ç”±æ–¼ä»–çš„é«˜ç»é çŸšï¼Œå¸¶é ˜å…¬å¸åº¦éæ­¤æ¬¡å…¨çƒé‡‘èå±æ©Ÿã€‚" },
            { idiom: "å¤§æ™ºè‹¥æ„š", pinyin: "dÃ  zhÃ¬ ruÃ² yÃº", bopomofo: "ã„‰ã„šË‹ ã„“Ë‹ ã„–ã„¨ã„›Ë‹ ã„©ËŠ", meaning: "æŒ‡æœ‰æ¥µé«˜æ™ºæ…§çš„äººï¼Œå¾€å¾€è¡¨é¢ä¸Šçœ‹èµ·ä¾†ä¼¼ä¹æ„šç¬¨ã€‚", example: "é€™ä½é•·è€…çš„ç‚ºäººè™•ä¸–ï¼Œçµ¦äººä¸€ç¨®å¤§æ™ºè‹¥æ„šçš„æ„Ÿå—ã€‚" }, // ç°¡åŒ–ä¾‹å¥ä»¥é©æ‡‰ç©ºé–“
            { idiom: "èµ´æ¹¯è¹ˆç«", pinyin: "fÃ¹ tÄng dÇo huÇ’", bopomofo: "ã„ˆã„¨Ë‹ ã„Šã„¤ ã„‰ã„ Ë‹ ã„ã„¨ã„›Ë‡", meaning: "æ¯”å–»å¥®ä¸é¡§èº«ï¼Œä¸é¿è‰±éšªã€‚", example: "ä»–æ—©å·²ä¸‹äº†èµ´æ¹¯è¹ˆç«çš„æ±ºå¿ƒï¼Œè¦æŒ‘æˆ°ä»»ä½•è‰±é›£éšªé˜»ã€‚" },
            { idiom: "å¦‚é›·è²«è€³", pinyin: "rÃº lÃ©i guÃ n Ä›r", bopomofo: "ã„–ã„¨ËŠ ã„Œã„ŸËŠ ã„ã„¨ã„¢Ë‹ ã„¦Ë‡", meaning: "å½¢å®¹äººçš„åæ°£å¾ˆå¤§ï¼Œçœ¾æ‰€å…±èã€‚", example: "è‡ªå¾ä»–å¾—åˆ°å¥§é‹é‡‘ç‰Œå¾Œï¼Œåœ¨é«”è‚²ç•Œå·²æ˜¯å¦‚é›·è²«è€³çš„äººç‰©ã€‚" }
        ];

        let currentCardIndex = 0;
        let currentMode = 'normal'; // 'normal', 'reverse', 'mcqMeaningToIdiom', 'mcqIdiomToMeaning'
        const flashcard = document.getElementById('flashcard');
        const flashcardFront = flashcard.querySelector('.flashcard-front');
        const flashcardBack = flashcard.querySelector('.flashcard-back');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const cardCounter = document.getElementById('card-counter');
        const feedbackMessageEl = document.getElementById('feedback-message');

        const modeButtons = {
            normal: document.getElementById('mode-normal'),
            reverse: document.getElementById('mode-reverse'),
            mcqMeaningToIdiom: document.getElementById('mode-mcq-meaning-to-idiom'),
            mcqIdiomToMeaning: document.getElementById('mode-mcq-idiom-to-meaning')
        };

        function updateFlashcard() {
            const currentIdiomData = idioms[currentCardIndex];
            feedbackMessageEl.textContent = '';
            flashcardFront.innerHTML = '';
            flashcardBack.innerHTML = ''; // æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“èƒŒé¢ï¼Œç¢ºä¿å…§å®¹æ­£ç¢º
            flashcardFront.style.justifyContent = 'center'; // é è¨­å‚ç›´å±…ä¸­

            // å¡ç‰‡èƒŒé¢å§‹çµ‚é¡¯ç¤ºå®Œæ•´è³‡è¨Š
            flashcardBack.innerHTML = `
                <div class="idiom-text">${currentIdiomData.idiom}</div>
                <div class="bopomofo-text">${currentIdiomData.bopomofo}</div>
                <h3>æ„æ€</h3>
                <p>${currentIdiomData.meaning}</p>
                <h3>ä¾‹å¥</h3>
                <p>${currentIdiomData.example}</p>
            `;

            if (currentMode === 'normal') {
                flashcardFront.innerHTML = `
                    <div class="idiom-text">${currentIdiomData.idiom}</div>
                    <div class="bopomofo-text">${currentIdiomData.bopomofo}</div>
                `;
            } else if (currentMode === 'reverse') {
                flashcardFront.innerHTML = `
                    <h3 class="mcq-question-title">é€™å€‹æˆèªçš„æ„æ€æ˜¯ï¼š</h3>
                    <p class="mcq-question-text">${currentIdiomData.meaning}</p>
                `;
            } else if (currentMode === 'mcqMeaningToIdiom') {
                flashcardFront.style.justifyContent = 'flex-start';
                flashcardFront.innerHTML = `
                    <h3 class="mcq-question-title">ä¸‹åˆ—å“ªå€‹æˆèªçš„æ„æ€æ˜¯ï¼š</h3>
                    <p class="mcq-question-text">${currentIdiomData.meaning}</p>
                `;
                generateMultipleChoiceOptions(currentIdiomData, 'mcqMeaningToIdiom');
            } else if (currentMode === 'mcqIdiomToMeaning') {
                flashcardFront.style.justifyContent = 'flex-start';
                flashcardFront.innerHTML = `
                    <div class="question-idiom-text">${currentIdiomData.idiom}</div>
                    <div class="question-bopomofo-text">${currentIdiomData.bopomofo}</div>
                    <h3 class="mcq-question-title">é€™å€‹æˆèªçš„æ„æ€æ˜¯ä¸‹åˆ—ä½•è€…ï¼Ÿ</h3>
                `;
                generateMultipleChoiceOptions(currentIdiomData, 'mcqIdiomToMeaning');
            }

            if (flashcard.classList.contains('is-flipped')) {
                flashcard.classList.remove('is-flipped');
            }
            cardCounter.textContent = `ç¬¬ ${currentCardIndex + 1} å¼µ / å…± ${idioms.length} å¼µ`;
            prevButton.disabled = currentCardIndex === 0;
            nextButton.disabled = currentCardIndex === idioms.length - 1;
        }

        function generateMultipleChoiceOptions(correctIdiomData, mode) {
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'multiple-choice-options';
            let optionsData = [correctIdiomData];
            const distractors = idioms.filter(idiom => idiom.idiom !== correctIdiomData.idiom);
            shuffleArray(distractors);

            for (let i = 0; i < Math.min(3, distractors.length); i++) {
                optionsData.push(distractors[i]);
            }
            shuffleArray(optionsData);

            optionsData.forEach(optionDataItem => {
                const button = document.createElement('button');
                button.className = 'choice-button';
                let buttonText, buttonValue;

                if (mode === 'mcqMeaningToIdiom') {
                    buttonText = optionDataItem.idiom;
                    buttonValue = optionDataItem.idiom;
                } else { // mcqIdiomToMeaning
                    buttonText = optionDataItem.meaning;
                    buttonValue = optionDataItem.meaning;
                }
                button.textContent = buttonText;
                button.dataset.value = buttonValue;

                button.addEventListener('click', (event) => {
                    event.stopPropagation();
                    handleMcqAnswer(buttonValue, correctIdiomData, optionsContainer, mode);
                });
                optionsContainer.appendChild(button);
            });
            flashcardFront.appendChild(optionsContainer);
        }

        function handleMcqAnswer(selectedValue, correctIdiomData, optionsContainer, mode) {
            const buttons = optionsContainer.querySelectorAll('.choice-button');
            let correctAnswerValue;
            let isCorrect;

            if (mode === 'mcqMeaningToIdiom') {
                correctAnswerValue = correctIdiomData.idiom;
                isCorrect = (selectedValue === correctAnswerValue);
            } else { // mcqIdiomToMeaning
                correctAnswerValue = correctIdiomData.meaning;
                isCorrect = (selectedValue === correctAnswerValue);
            }

            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.dataset.value === correctAnswerValue) {
                    btn.classList.add('correct');
                }
                if (btn.dataset.value === selectedValue && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                feedbackMessageEl.textContent = 'ç­”å°äº†ï¼ ğŸ‰';
                feedbackMessageEl.style.color = '#38A169';
            } else {
                const feedbackText = mode === 'mcqMeaningToIdiom' ? `ç­”éŒ¯äº†ã€‚æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${correctAnswerValue}` : `ç­”éŒ¯äº†ã€‚æ­£ç¢ºæ„æ€æ˜¯ï¼šã€Œ${correctAnswerValue}ã€`;
                feedbackMessageEl.textContent = feedbackText;
                feedbackMessageEl.style.color = '#E53E3E';
            }
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function setMode(mode) {
            currentMode = mode;
            Object.values(modeButtons).forEach(btn => btn.classList.remove('active'));
            if (modeButtons[mode]) {
                modeButtons[mode].classList.add('active');
            }
            currentCardIndex = 0;
            updateFlashcard();
        }

        Object.keys(modeButtons).forEach(modeKey => {
            if (modeButtons[modeKey]) {
                modeButtons[modeKey].addEventListener('click', () => setMode(modeKey));
            }
        });

        flashcard.addEventListener('click', () => {
            flashcard.classList.toggle('is-flipped');
        });

        prevButton.addEventListener('click', () => {
            if (currentCardIndex > 0) {
                currentCardIndex--;
                updateFlashcard();
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentCardIndex < idioms.length - 1) {
                currentCardIndex++;
                updateFlashcard();
            }
        });

        setMode('normal'); // é è¨­ç‚ºæ­£å‘æ¨¡å¼
    </script>

</body>
</html>
