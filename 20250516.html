<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆèªäº’å‹•ç·´ç¿’</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0f9ff; /* Light blue background */
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease-in-out;
        }
        .card:hover:not(.no-hover) {
            transform: translateY(-5px);
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
            cursor: pointer;
            border: none;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .btn-primary { background-color: #3b82f6; color: white; }
        .btn-primary:hover { background-color: #2563eb; transform: translateY(-2px); }
        .btn-secondary { background-color: #6b7280; color: white; }
        .btn-secondary:hover { background-color: #4b5563; transform: translateY(-2px); }
        .btn-green { background-color: #10b981; color: white; }
        .btn-green:hover { background-color: #059669; }
        .btn-red { background-color: #ef4444; color: white; }
        .btn-red:hover { background-color: #dc2626; }
        .btn-orange { background-color: #f97316; color: white; }
        .btn-orange:hover { background-color: #ea580c; }
        .btn-purple { background-color: #8b5cf6; color: white; } /* Purple for comprehensive */
        .btn-purple:hover { background-color: #7c3aed; }
        .btn-teal { background-color: #14b8a6; color: white; } /* Teal for synonym/antonym */
        .btn-teal:hover { background-color: #0d9488; }

        .option-btn {
            width: 100%;
            text-align: left;
            background-color: #e5e7eb; color: #1f2937;
            margin-bottom: 0.5rem; padding: 0.75rem;
        }
        .option-btn:hover { background-color: #d1d5db; }
        .option-btn.correct { background-color: #34d399; color: white; border: 2px solid #059669; }
        .option-btn.incorrect { background-color: #f87171; color: white; border: 2px solid #dc2626; }
        .disabled-options .option-btn:not(.correct):not(.incorrect) { opacity: 0.7; pointer-events: none; }

        .bopomofo { color: #4b5563; font-size: 1.125rem; }
        #feedbackMessage { min-height: 2.5rem; font-size: 1.125rem; }
        .sentence-blank { font-weight: bold; color: #dc2626; }
        .hidden-meaning #cardMeaning, .hidden-meaning #cardSentence,
        .hidden-meaning #cardSynonymsContainer, .hidden-meaning #cardAntonymsContainer { display: none; } /* Updated IDs */
        .synonym-antonym-label { font-weight: 500; color: #374151; margin-top: 0.5rem;}
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 selection:bg-blue-200">

    <div id="mainContainer" class="w-full max-w-3xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-blue-600">æˆèªäº’å‹•ç·´ç¿’</h1>
        </header>

        <div id="modeSelection" class="card p-6 md:p-8 text-center no-hover">
            <h2 class="text-2xl font-semibold mb-6 text-gray-700">é¸æ“‡ç·´ç¿’æ¨¡å¼</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                <button id="startCardModeBtn" class="btn btn-primary">å¡ç‰‡æ¨¡å¼</button>
                <button id="startQuizIdiomToMeaningBtn" class="btn btn-primary">çœ‹æˆèªé¸æ„æ€</button>
                <button id="startQuizMeaningToIdiomBtn" class="btn btn-primary">çœ‹æ„æ€é¸æˆèª</button>
                <button id="startFillInTheBlankBtn" class="btn btn-primary">ä¾‹å¥å¡«ç©º</button>
                <button id="startFindSynonymBtn" class="btn btn-teal">æ‰¾è¿‘ç¾©è©</button>
                <button id="startFindAntonymBtn" class="btn btn-teal">æ‰¾åç¾©è©</button>
                <button id="startComprehensiveBtn" class="btn btn-purple col-span-1 sm:col-span-2 md:col-span-3">ç¶œåˆç·´ç¿’</button>
                <button id="startIncorrectReviewBtn" class="btn btn-orange col-span-1 sm:col-span-2 md:col-span-3 hidden">ç·´ç¿’éŒ¯é¡Œ</button>
            </div>
        </div>

        <div id="cardMode" class="hidden card p-6 md:p-8 no-hover">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-semibold text-gray-700">å¡ç‰‡æ¨¡å¼</h2>
                <button id="toggleMeaningBtn" class="btn btn-secondary btn-sm py-1 px-3 text-sm">éš±è—æ„æ€</button>
            </div>
            <div id="cardContent" class="mb-6 p-6 bg-blue-50 rounded-lg min-h-[300px] flex flex-col justify-center">
                <h3 id="cardIdiom" class="text-3xl font-bold text-blue-700 mb-2"></h3>
                <p id="cardBopomofo" class="bopomofo mb-4"></p>
                <p id="cardMeaning" class="text-gray-700 text-base mb-3"></p>
                <p id="cardSentence" class="text-sm text-gray-600 italic mb-3"></p>
                <div id="cardSynonymsContainer" class="mb-2"> {/* Changed ID */}
                    <span class="synonym-antonym-label">è¿‘ç¾©è©ï¼š</span><span id="cardSynonyms" class="text-sm text-gray-600"></span> {/* Changed ID */}
                </div>
                <div id="cardAntonymsContainer"> {/* Changed ID */}
                    <span class="synonym-antonym-label">åç¾©è©ï¼š</span><span id="cardAntonyms" class="text-sm text-gray-600"></span> {/* Changed ID */}
                </div>
            </div>
            <div class="flex justify-between items-center mb-4">
                <button id="prevCardBtn" class="btn btn-secondary">ä¸Šä¸€å¼µ</button>
                <p id="cardCounter" class="text-sm text-gray-500"></p>
                <button id="nextCardBtn" class="btn btn-secondary">ä¸‹ä¸€å¼µ</button>
            </div>
            <button id="backToMenuFromCardBtn" class="btn btn-primary w-full mt-4">è¿”å›ä¸»é¸å–®</button>
        </div>

        <div id="quizMode" class="hidden card p-6 md:p-8 no-hover">
            <h2 id="quizTitle" class="text-2xl font-semibold mb-2 text-center text-gray-700">æ¸¬é©—æ¨¡å¼</h2>
            <p id="quizProgress" class="text-sm text-gray-500 text-center mb-4"></p>
            <div id="questionArea" class="mb-6 p-6 bg-yellow-50 rounded-lg min-h-[120px] flex flex-col items-center justify-center text-center">
                <p id="questionText" class="text-xl font-medium text-yellow-800"></p>
                <p id="questionBopomofo" class="bopomofo text-yellow-700 mt-1"></p>
            </div>
            <div id="optionsArea" class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4"></div>
            <div id="feedbackMessage" class="text-center font-medium mb-4"></div>
            <button id="nextQuestionBtn" class="btn btn-green w-full mb-4 hidden">ä¸‹ä¸€é¡Œ</button>
            <button id="backToMenuFromQuizBtn" class="btn btn-primary w-full">è¿”å›ä¸»é¸å–®</button>
        </div>
    </div>

    <script>
        // æˆèªé¡Œåº« (è¿‘ç¾©/åç¾©è©åƒ…åŒ…å«åœ–ç‰‡ä¸­æ˜ç¢ºæ¨™ç¤ºè€…)
        const idioms = [
            { idiom: "èæœƒè²«é€š", bopomofo: "ã„–ã„¨ã„¥ËŠ ã„ã„¨ã„ŸË‹ ã„ã„¨ã„¢Ë‹ ã„Šã„¨ã„¥", meaning: "å°‡å„ç¨®ç›¸é—œçš„çŸ¥è­˜æˆ–äº‹ç‰©åŠ ä»¥èåˆã€è²«ç©¿ï¼Œé€²è€Œç²å¾—å…¨é¢é€šå¾¹çš„é ˜æœƒã€‚", sentence: "è®€æ›¸è‹¥èƒ½ __BLANK__ ï¼Œä¾¿å¯ä»¥å°‡æ‰€å­¸éˆæ´»é‹ç”¨ã€‚", blankWord: "èæœƒè²«é€š", synonyms: ["å¿ƒé ˜ç¥æœƒ"], antonyms: [] }, // Image 1: è¿‘ç¾© å¿ƒé ˜ç¥æœƒ
            { idiom: "å¦‚é›·è²«è€³", bopomofo: "ã„–ã„¨ËŠ ã„Œã„ŸËŠ ã„ã„¨ã„¢Ë‹ ã„¦Ë‡", meaning: "æ¯”å–»äººåæ°£å¾ˆå¤§ï¼Œçœ¾æ‰€å…±èã€‚", sentence: "é€™ä½å¤§ç•«å®¶çš„åè²æ—©å·² __BLANK__ ï¼Œç„¡äººä¸æ›‰ã€‚", blankWord: "å¦‚é›·è²«è€³", synonyms: [], antonyms: [] },
            { idiom: "åŠæ–¤å…«å…©", bopomofo: "ã„…ã„¢Ë‹ ã„ã„§ã„£ ã„…ã„š ã„Œã„§ã„¤Ë‡", meaning: "æ¯”å–»å½¼æ­¤ç›¸ç•¶ï¼Œä¸ç›¸ä¸Šä¸‹ã€‚", sentence: "ä»–å€‘å…©éšŠå¯¦åŠ› __BLANK__ ï¼Œçœ‹ä¾†æœƒæ˜¯å ´æ¿€çƒˆçš„æ¯”è³½ã€‚", blankWord: "åŠæ–¤å…«å…©", synonyms: ["ä¸ç›¸ä¸Šä¸‹"], antonyms: ["å¤©å·®åœ°é "] }, // Image 1: (ä¸ç›¸ä¸Šä¸‹ is part of its definition), åç¾© å¤©å·®åœ°é 
            { idiom: "å…¨ç¥è²«æ³¨", bopomofo: "ã„‘ã„©ã„¢ËŠ ã„•ã„£ËŠ ã„ã„¨ã„¢Ë‹ ã„“ã„¨Ë‹", meaning: "ç²¾ç¥é«˜åº¦é›†ä¸­ï¼Œæ³¨æ„åŠ›å®Œå…¨å‡èšã€‚", sentence: "ä»– __BLANK__ åœ°è†è½è€å¸«è¬›èª²ï¼Œä¸éŒ¯éä»»ä½•ç´°ç¯€ã€‚", blankWord: "å…¨ç¥è²«æ³¨", synonyms: [], antonyms: [] },
            { idiom: "èˆ‰ä¸–èå", bopomofo: "ã„ã„©Ë‡ ã„•Ë‹ ã„¨ã„£ËŠ ã„‡ã„§ã„¥ËŠ", meaning: "å…¨ä¸–ç•Œéƒ½çŸ¥é“ï¼Œå½¢å®¹éå¸¸è‘—åã€‚", sentence: "é€™åº§åŸå¸‚çš„å¤œæ™¯ __BLANK__ ï¼Œå¸å¼•äº†è¨±å¤šéŠå®¢ã€‚", blankWord: "èˆ‰ä¸–èå", synonyms: [], antonyms: [] },
            { idiom: "å…¨åŠ›ä»¥èµ´", bopomofo: "ã„‘ã„©ã„¢ËŠ ã„Œã„§Ë‹ ã„§Ë‡ ã„ˆã„¨Ë‹", meaning: "ç”¨ç›¡å…¨éƒ¨çš„åŠ›é‡å»åšæŸä»¶äº‹æƒ…ã€‚", sentence: "ç„¡è«–æœªä¾†é¢è‡¨å¤šå°‘æŒ‘æˆ°ï¼Œæˆ‘éƒ½æœƒ __BLANK__ ï¼Œå¯¦ç¾å¤¢æƒ³ã€‚", blankWord: "å…¨åŠ›ä»¥èµ´", synonyms: [], antonyms: [] },
            { idiom: "ç„¡æ€¨ç„¡æ‚”", bopomofo: "ã„¨ËŠ ã„©ã„¢Ë‹ ã„¨ËŠ ã„ã„¨ã„ŸË‡", meaning: "æ²’æœ‰ä»»ä½•æ€¨æ¨å’Œå¾Œæ‚”ã€‚", sentence: "å¥¶å¥¶ç•¶å¿—å·¥é›–ç„¶å·¥ä½œç¹é‡ï¼Œå» __BLANK__ ã€æ¨‚æ­¤ä¸ç–²ã€‚", blankWord: "ç„¡æ€¨ç„¡æ‚”", synonyms: [], antonyms: [] },
            { idiom: "æŸä¹‹é«˜é–£", bopomofo: "ã„•ã„¨Ë‹ ã„“ ã„ã„  ã„ã„œËŠ", meaning: "æŠŠæ±è¥¿æ†èµ·ä¾†ï¼Œæ”¾ç½®æ–¼é–£æ¨“ä¸Šã€‚æ¯”å–»æ£„ç½®ä¸ç”¨ã€‚", sentence: "é€™å€‹è¨ˆç•«å› è³‡é‡‘ä¸è¶³ï¼Œåªå¥½æš«æ™‚ __BLANK__ ã€‚", blankWord: "æŸä¹‹é«˜é–£", synonyms: [], antonyms: ["ç‰©ç›¡å…¶ç”¨"] }, // Image 3: åç¾© ç‰©ç›¡å…¶ç”¨
            { idiom: "å†¥é ‘ä¸éˆ", bopomofo: "ã„‡ã„§ã„¥ËŠ ã„¨ã„¢ËŠ ã„…ã„¨Ë‹ ã„Œã„§ã„¥ËŠ", meaning: "æ„šæ˜§é ‘å›ºè€Œä¸é€šæƒ…ç†ã€‚", sentence: "æœ‰äº›äººå°±æ˜¯ __BLANK__ ï¼Œæ€éº¼å‹¸ä¹Ÿè½ä¸é€²å»ã€‚", blankWord: "å†¥é ‘ä¸éˆ", synonyms: [], antonyms: [] },
            { idiom: "å®¶å¾’å››å£", bopomofo: "ã„ã„§ã„š ã„Šã„¨ËŠ ã„™Ë‹ ã„…ã„§Ë‹", meaning: "å®¶ä¸­åªå‰©ä¸‹å››å‘¨çš„ç‰†å£ã€‚å½¢å®¹å®¶å¢ƒæ¥µç‚ºè²§å›°ã€‚", sentence: "ä»–æ—©å¹´ __BLANK__ ï¼Œå»é è‘—æ¯…åŠ›ç™½æ‰‹èµ·å®¶ã€‚", blankWord: "å®¶å¾’å››å£", synonyms: ["ä¸€è²§å¦‚æ´—"], antonyms: ["è…°çºè¬è²«"] }, // Image 3: è¿‘ç¾© ä¸€è²§å¦‚æ´—, åç¾© è…°çºè¬è²«
            { idiom: "ä¸€ç±Œè«å±•", bopomofo: "ã„§Ë‹ ã„”ã„¡ËŠ ã„‡ã„›Ë‹ ã„“ã„¢Ë‡", meaning: "ä¸€é»è¨ˆç­–ä¹Ÿæ–½å±•ä¸å‡ºä¾†ã€‚æ¯”å–»æ¯«ç„¡è¾¦æ³•ã€‚", sentence: "é¢å°é€™å€‹è¤‡é›œçš„å•é¡Œï¼Œä»–ä¸€æ™‚ __BLANK__ ã€‚", blankWord: "ä¸€ç±Œè«å±•", synonyms: ["æŸæ‰‹ç„¡ç­–"], antonyms: ["èƒ¸æœ‰æˆç«¹"] }, // Image 3: è¿‘ç¾© æŸæ‰‹ç„¡ç­–, åç¾© èƒ¸æœ‰æˆç«¹
            { idiom: "ä¾†é¾å»è„ˆ", bopomofo: "ã„Œã„ËŠ ã„Œã„¨ã„¥ËŠ ã„‘ã„©Ë‹ ã„‡ã„Ë‹", meaning: "æ¯”å–»äº‹æƒ…çš„å§‹æœ«å’ŒåŸå§”ã€‚", sentence: "è­¦æ–¹æ­£åœ¨èª¿æŸ¥äº‹ä»¶çš„ __BLANK__ ã€‚", blankWord: "ä¾†é¾å»è„ˆ", synonyms: ["å‰å› å¾Œæœ"], antonyms: [] }, // Image 3: è¿‘ç¾© å‰å› å¾Œæœ
            { idiom: "æ—¥å¾©ä¸€æ—¥", bopomofo: "ã„–Ë‹ ã„ˆã„¨Ë‹ ã„§ËŠ ã„–Ë‹", meaning: "ä¸€å¤©åˆä¸€å¤©ï¼Œå½¢å®¹æ—¥å­é‡è¤‡æˆ–æ™‚é–“æµé€ã€‚", sentence: "ä»– __BLANK__ åœ°è¾›å‹¤å·¥ä½œï¼Œå¸Œæœ›èƒ½æ”¹å–„å®¶è£¡çš„ç¶“æ¿Ÿç‹€æ³ã€‚", blankWord: "æ—¥å¾©ä¸€æ—¥", synonyms: [], antonyms: [] },
            { idiom: "è‹¦ä¸å ªè¨€", bopomofo: "ã„ã„¨Ë‡ ã„…ã„¨Ë‹ ã„ã„¢ ã„§ã„¢ËŠ", meaning: "ç—›è‹¦å¾—ç„¡æ³•ç”¨è¨€èªä¾†å½¢å®¹ã€‚", sentence: "ç‰™ç—›èµ·ä¾†çœŸæ˜¯è®“äºº __BLANK__ ã€‚", blankWord: "è‹¦ä¸å ªè¨€", synonyms: [], antonyms: [] },
            { idiom: "å®¶å¸¸ä¾¿é£¯", bopomofo: "ã„ã„§ã„š ã„”ã„¤ËŠ ã„…ã„§ã„¢Ë‹ ã„ˆã„¢Ë‹", meaning: "å®¶ä¸­çš„æ—¥å¸¸é£¯é£Ÿã€‚æ¯”å–»å¾ˆå¹³å¸¸ã€å¾ˆæ™®é€šçš„äº‹ã€‚", sentence: "å°ä»–è€Œè¨€ï¼Œç†¬å¤œåŠ ç­å·²ç¶“æ˜¯ __BLANK__ äº†ã€‚", blankWord: "å®¶å¸¸ä¾¿é£¯", synonyms: [], antonyms: [] },
            { idiom: "æ…æ€æ˜è¾¨", bopomofo: "ã„•ã„£Ë‹ ã„™ ã„‡ã„§ã„¥ËŠ ã„…ã„§ã„¢Ë‹", meaning: "è¬¹æ…æ€è€ƒï¼Œæ˜ç™½åˆ†è¾¨æ˜¯éã€‚", sentence: "åœ¨è³‡è¨Šçˆ†ç‚¸çš„æ™‚ä»£ï¼Œæˆ‘å€‘æ›´éœ€è¦ __BLANK__ çš„èƒ½åŠ›ã€‚", blankWord: "æ…æ€æ˜è¾¨", synonyms: [], antonyms: [] },
            { idiom: "å¤§é–‹çœ¼ç•Œ", bopomofo: "ã„‰ã„šË‹ ã„ã„ ã„§ã„¢Ë‡ ã„ã„§ã„Ë‹", meaning: "é–‹é—Šè¦–é‡ï¼Œå¢é•·è¦‹è­˜ã€‚", sentence: "é€™æ¬¡çš„åšç‰©é¤¨åƒè§€ï¼ŒçœŸè®“æˆ‘ __BLANK__ ã€‚", blankWord: "å¤§é–‹çœ¼ç•Œ", synonyms: [], antonyms: [] },
            { idiom: "æ¯«ç„¡é ­ç·’", bopomofo: "ã„ã„ ËŠ ã„¨ËŠ ã„Šã„¡ËŠ ã„’ã„©Ë‹", meaning: "ä¸€é»ç·šç´¢æˆ–è¾¦æ³•ä¹Ÿæ²’æœ‰ã€‚", sentence: "å°æ–¼é€™å€‹è¬é¡Œï¼Œæˆ‘ç›®å‰ä»ç„¶ __BLANK__ ã€‚", blankWord: "æ¯«ç„¡é ­ç·’", synonyms: [], antonyms: [] },
            { idiom: "æ´—è€³æ­è½", bopomofo: "ã„’ã„§Ë‡ ã„¦Ë‡ ã„ã„¨ã„¥ ã„Šã„§ã„¥", meaning: "æ¯”å–»å°ˆå¿ƒæ­æ•¬åœ°è½åˆ¥äººèªªè©±ã€‚", sentence: "æ‚¨æœ‰ä»€éº¼å¯¶è²´æ„è¦‹ï¼Œæˆ‘ä¸€å®š __BLANK__ ã€‚", blankWord: "æ´—è€³æ­è½", synonyms: [], antonyms: ["å……è€³ä¸è"] }, // Image 6: åç¾© å……è€³ä¸è
            { idiom: "è² èŠè«‹ç½ª", bopomofo: "ã„ˆã„¨Ë‹ ã„ã„§ã„¥ ã„‘ã„§ã„¥Ë‡ ã„—ã„¨ã„ŸË‹", meaning: "èƒŒè‘—èŠæ¢å‘å°æ–¹æ‰¿èªéŒ¯èª¤ï¼Œè«‹æ±‚è²¬ç½°ã€‚", sentence: "ä»–çŸ¥é“è‡ªå·±éŒ¯äº†ï¼Œä¾¿ç™»é–€ __BLANK__ ã€‚", blankWord: "è² èŠè«‹ç½ª", synonyms: [], antonyms: [] },
            { idiom: "æŠ«èŠæ–¬æ£˜", bopomofo: "ã„†ã„§ ã„ã„§ã„¥ ã„“ã„¢Ë‡ ã„ã„§ËŠ", meaning: "æ¯”å–»å…‹æœå›°é›£ï¼Œæƒé™¤éšœç¤™ã€‚", sentence: "ä»–å€‘ä¸€è·¯ __BLANK__ ï¼Œçµ‚æ–¼æˆåŠŸå»ºç«‹äº†äº‹æ¥­ã€‚", blankWord: "æŠ«èŠæ–¬æ£˜", synonyms: ["ä¹˜é¢¨ç ´æµª"], antonyms: ["ç•ç¸®ä¸å‰"] }, // Image 7: è¿‘ç¾© ä¹˜é¢¨ç ´æµª, åç¾© ç•ç¸®ä¸å‰
            { idiom: "ç§»é¢¨æ˜“ä¿—", bopomofo: "ã„§ËŠ ã„ˆã„¥ ã„§Ë‹ ã„™ã„¨ËŠ", meaning: "æ”¹å–„ä¸è‰¯çš„ç¤¾æœƒé¢¨æ°£å’Œç¿’ä¿—ã€‚", sentence: "æ•™è‚²æ˜¯ __BLANK__ çš„é‡è¦æ‰‹æ®µã€‚", blankWord: "ç§»é¢¨æ˜“ä¿—", synonyms: [], antonyms: [] },
            { idiom: "å’«å°ºå¤©æ¶¯", bopomofo: "ã„“Ë‡ ã„”Ë‡ ã„Šã„§ã„¢ ã„§ã„šËŠ", meaning: "æ¯”å–»è·é›¢é›–è¿‘ï¼Œå»åƒé åœ¨å¤©é‚Šä¸€æ¨£ã€‚", sentence: "ä»–å€‘å€†é›–æ˜¯é„°å±…ï¼Œå»å› å¿™ç¢Œè€Œ __BLANK__ ï¼Œé›£å¾—è¦‹é¢ã€‚", blankWord: "å’«å°ºå¤©æ¶¯", synonyms: [], antonyms: ["å¤©æ¶¯è‹¥æ¯”é„°"] }, // Image 7: åç¾© å¤©æ¶¯è‹¥æ¯”é„°
            { idiom: "ä¸€å¸†é¢¨é †", bopomofo: "ã„§Ë‹ ã„ˆã„¢ËŠ ã„ˆã„¥ ã„•ã„¨ã„£Ë‹", meaning: "æ¯”å–»éå¸¸é †åˆ©ï¼Œæ¯«ç„¡é˜»ç¤™ã€‚", sentence: "ç¥ä½ æ­¤è¡Œ __BLANK__ ï¼Œæ”¶ç©«æ»¿æ»¿ã€‚", blankWord: "ä¸€å¸†é¢¨é †", synonyms: ["ä¸€è·¯é †é¢¨"], antonyms: ["ä¸€æ³¢ä¸‰æŠ˜"] }, // Image 7: è¿‘ç¾© ä¸€è·¯é †é¢¨, åç¾© ä¸€æ³¢ä¸‰æŠ˜
            { idiom: "é«˜ç»é çŸš", bopomofo: "ã„ã„  ã„“ã„¢ ã„©ã„¢Ë‡ ã„“ã„¨Ë‡", meaning: "çœ‹å¾—é«˜é ï¼Œå½¢å®¹è¦‹è­˜é å¤§ã€‚", sentence: "åˆ¶å®šåœ‹å®¶æ”¿ç­–éœ€è¦ __BLANK__ çš„çœ¼å…‰ã€‚", blankWord: "é«˜ç»é çŸš", synonyms: ["ç›®å…‰å¦‚ç‚¬"], antonyms: ["ç›®å…‰å¦‚è±†"] }, // Image 8: è¿‘ç¾© ç›®å…‰å¦‚ç‚¬, åç¾© ç›®å…‰å¦‚è±†
            { idiom: "å¤§æ™ºè‹¥æ„š", bopomofo: "ã„‰ã„šË‹ ã„“Ë‹ ã„–ã„¨ã„›Ë‹ ã„©ËŠ", meaning: "æœ‰æ¥µé«˜æ™ºæ…§çš„äººï¼Œè¡¨é¢ä¸Šçœ‹èµ·ä¾†ä¼¼ä¹æ„šç¬¨ã€‚", sentence: "ä»–å¹³æ™‚ä¸å¤šè©±ï¼Œå…¶å¯¦æ˜¯ __BLANK__ ï¼Œæ·±è—ä¸éœ²ã€‚", blankWord: "å¤§æ™ºè‹¥æ„š", synonyms: ["æ·±è—ä¸éœ²"], antonyms: ["é‹’èŠ’ç•¢éœ²"] }, // Image 8: è¿‘ç¾© æ·±è—ä¸éœ², åç¾© é‹’èŠ’ç•¢éœ²
            { idiom: "èµ´æ¹¯è¹ˆç«", bopomofo: "ã„ˆã„¨Ë‹ ã„Šã„¤ ã„‰ã„ Ë‹ ã„ã„¨ã„›Ë‡", meaning: "æ¯”å–»å¥®ä¸é¡§èº«ï¼Œä¸é¿è‰±éšªã€‚", sentence: "ç‚ºäº†æ•‘äººï¼Œæ¶ˆé˜²å“¡å€‘å€‹å€‹ __BLANK__ ã€‚", blankWord: "èµ´æ¹¯è¹ˆç«", synonyms: ["å¥®ä¸é¡§èº«"], antonyms: ["è²ªç”Ÿæ€•æ­»"] }  // Image 8: è¿‘ç¾© å¥®ä¸é¡§èº«, åç¾© è²ªç”Ÿæ€•æ­»
        ];

        let currentIdiomIndex = 0;
        let currentQuizSet = [];
        let currentQuestionData = {}; 
        let currentQuestionDisplayIndex = 0;
        let score = 0;
        let activeQuizType = '';
        let autoNextTimer = null;
        let incorrectlyAnsweredIdioms = JSON.parse(localStorage.getItem('incorrectlyAnsweredIdioms')) || [];

        // DOM Elements (shortened for brevity, assume they are correctly fetched as in previous version)
        const modeSelectionDiv = document.getElementById('modeSelection');
        const cardModeDiv = document.getElementById('cardMode');
        const quizModeDiv = document.getElementById('quizMode');
        const cardIdiomEl = document.getElementById('cardIdiom');
        const cardBopomofoEl = document.getElementById('cardBopomofo');
        const cardMeaningEl = document.getElementById('cardMeaning');
        const cardSentenceEl = document.getElementById('cardSentence');
        const cardSynonymsEl = document.getElementById('cardSynonyms'); // Direct span
        const cardAntonymsEl = document.getElementById('cardAntonyms'); // Direct span
        const toggleMeaningBtn = document.getElementById('toggleMeaningBtn');
        const prevCardBtn = document.getElementById('prevCardBtn');
        const nextCardBtn = document.getElementById('nextCardBtn');
        const cardCounterEl = document.getElementById('cardCounter');
        const backToMenuFromCardBtn = document.getElementById('backToMenuFromCardBtn');
        const quizTitleEl = document.getElementById('quizTitle');
        const questionTextEl = document.getElementById('questionText');
        const questionBopomofoEl = document.getElementById('questionBopomofo');
        const optionsAreaEl = document.getElementById('optionsArea');
        const feedbackMessageEl = document.getElementById('feedbackMessage');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const backToMenuFromQuizBtn = document.getElementById('backToMenuFromQuizBtn');
        const quizProgressEl = document.getElementById('quizProgress');
        const startIncorrectReviewBtn = document.getElementById('startIncorrectReviewBtn');
        // Buttons for starting modes
        const startCardModeBtn = document.getElementById('startCardModeBtn');
        const startQuizIdiomToMeaningBtn = document.getElementById('startQuizIdiomToMeaningBtn');
        const startQuizMeaningToIdiomBtn = document.getElementById('startQuizMeaningToIdiomBtn');
        const startFillInTheBlankBtn = document.getElementById('startFillInTheBlankBtn');
        const startFindSynonymBtn = document.getElementById('startFindSynonymBtn');
        const startFindAntonymBtn = document.getElementById('startFindAntonymBtn');
        const startComprehensiveBtn = document.getElementById('startComprehensiveBtn');


        function updateIncorrectReviewButton() {
            if (incorrectlyAnsweredIdioms.length > 0) {
                startIncorrectReviewBtn.classList.remove('hidden');
                startIncorrectReviewBtn.textContent = `ç·´ç¿’éŒ¯é¡Œ (${incorrectlyAnsweredIdioms.length})`;
            } else {
                startIncorrectReviewBtn.classList.add('hidden');
            }
        }

        function saveIncorrectlyAnsweredIdioms() {
            localStorage.setItem('incorrectlyAnsweredIdioms', JSON.stringify(incorrectlyAnsweredIdioms));
            updateIncorrectReviewButton();
        }

        function addIncorrectIdiom(idiomData, questionType) {
            const uniqueId = idiomData.idiom + "_" + questionType;
            if (!incorrectlyAnsweredIdioms.some(item => (item.idiomData.idiom + "_" + item.questionType) === uniqueId)) {
                incorrectlyAnsweredIdioms.push({ idiomData: idiomData, questionType: questionType });
                saveIncorrectlyAnsweredIdioms();
            }
        }

        function removeCorrectlyAnsweredFromIncorrectList(idiomData, questionType) {
             const uniqueId = idiomData.idiom + "_" + questionType;
            incorrectlyAnsweredIdioms = incorrectlyAnsweredIdioms.filter(item => (item.idiomData.idiom + "_" + item.questionType) !== uniqueId);
            saveIncorrectlyAnsweredIdioms();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function showModeSelection() {
            modeSelectionDiv.classList.remove('hidden');
            cardModeDiv.classList.add('hidden');
            quizModeDiv.classList.add('hidden');
            clearTimeout(autoNextTimer);
            updateIncorrectReviewButton();
        }

        function displayCard(index, sourceArray = idioms) {
            const idiomData = sourceArray[index];
            cardIdiomEl.textContent = idiomData.idiom;
            cardBopomofoEl.textContent = idiomData.bopomofo;
            cardMeaningEl.textContent = idiomData.meaning;
            cardSentenceEl.textContent = idiomData.sentence ? `ä¾‹å¥ï¼š${idiomData.sentence.replace("__BLANK__", `ã€Œ${idiomData.blankWord}ã€`)}` : "";
            cardSynonymsEl.textContent = idiomData.synonyms && idiomData.synonyms.length > 0 ? idiomData.synonyms.join('ã€') : 'ç„¡';
            cardAntonymsEl.textContent = idiomData.antonyms && idiomData.antonyms.length > 0 ? idiomData.antonyms.join('ã€') : 'ç„¡';
            cardCounterEl.textContent = `${index + 1} / ${sourceArray.length}`;
        }
        
        toggleMeaningBtn.addEventListener('click', () => {
            const cardContentDiv = document.getElementById('cardContent');
            // Toggle visibility for meaning, sentence, and synonym/antonym containers
            document.getElementById('cardMeaning').classList.toggle('hidden');
            document.getElementById('cardSentence').classList.toggle('hidden');
            document.getElementById('cardSynonymsContainer').classList.toggle('hidden');
            document.getElementById('cardAntonymsContainer').classList.toggle('hidden');

            // Add a master class to cardContent for easier CSS targeting if needed, or rely on individual toggles
            cardContentDiv.classList.toggle('hidden-meaning-master'); // Example of a master class

            if (document.getElementById('cardMeaning').classList.contains('hidden')) {
                toggleMeaningBtn.textContent = 'é¡¯ç¤ºè©³ç´°'; // Changed text
            } else {
                toggleMeaningBtn.textContent = 'éš±è—è©³ç´°'; // Changed text
            }
        });

        function initCardMode() {
            modeSelectionDiv.classList.add('hidden');
            cardModeDiv.classList.remove('hidden');
            // Reset visibility state when entering card mode
            document.getElementById('cardMeaning').classList.remove('hidden');
            document.getElementById('cardSentence').classList.remove('hidden');
            document.getElementById('cardSynonymsContainer').classList.remove('hidden');
            document.getElementById('cardAntonymsContainer').classList.remove('hidden');
            document.getElementById('cardContent').classList.remove('hidden-meaning-master');
            toggleMeaningBtn.textContent = 'éš±è—è©³ç´°';
            currentIdiomIndex = 0;
            displayCard(currentIdiomIndex);
        }


        prevCardBtn.addEventListener('click', () => {
            currentIdiomIndex = (currentIdiomIndex - 1 + idioms.length) % idioms.length;
            displayCard(currentIdiomIndex);
        });

        nextCardBtn.addEventListener('click', () => {
            currentIdiomIndex = (currentIdiomIndex + 1) % idioms.length;
            displayCard(currentIdiomIndex);
        });

        function getDistractorOptions(currentIdiomData, type, count) {
            let distractors = [];
            const allOtherIdioms = idioms.filter(i => i.idiom !== currentIdiomData.idiom);
            shuffleArray(allOtherIdioms);

            let correctAnswersForCurrent = [];
            if (type === 'synonym' && currentIdiomData.synonyms) correctAnswersForCurrent = currentIdiomData.synonyms;
            if (type === 'antonym' && currentIdiomData.antonyms) correctAnswersForCurrent = currentIdiomData.antonyms;


            for (let idiom of allOtherIdioms) {
                if (distractors.length >= count) break;
                let potentialDistractor = null;
                if (type === 'synonym' && idiom.synonyms && idiom.synonyms.length > 0) {
                    potentialDistractor = idiom.synonyms[Math.floor(Math.random() * idiom.synonyms.length)];
                } else if (type === 'antonym' && idiom.antonyms && idiom.antonyms.length > 0) {
                    potentialDistractor = idiom.antonyms[Math.floor(Math.random() * idiom.antonyms.length)];
                } else if (type === 'meaning') {
                    potentialDistractor = idiom.meaning;
                } else if (type === 'idiom') {
                    potentialDistractor = idiom.idiom;
                }
                
                // Ensure distractor is not null, not already included, and not one of the correct answers for the current question
                if (potentialDistractor && !distractors.includes(potentialDistractor) && !correctAnswersForCurrent.includes(potentialDistractor) ) {
                    distractors.push(potentialDistractor);
                }
            }
            
            // Fallback if not enough unique distractors
            let fallbackAttempt = 0;
            while(distractors.length < count && fallbackAttempt < idioms.length) {
                const randomFallbackIdiom = idioms[Math.floor(Math.random() * idioms.length)];
                let fallbackValue = randomFallbackIdiom.idiom; // Default fallback to idiom name

                if (type === 'meaning') fallbackValue = randomFallbackIdiom.meaning;
                else if (type === 'synonym' && randomFallbackIdiom.synonyms && randomFallbackIdiom.synonyms.length > 0) fallbackValue = randomFallbackIdiom.synonyms[0];
                else if (type === 'antonym' && randomFallbackIdiom.antonyms && randomFallbackIdiom.antonyms.length > 0) fallbackValue = randomFallbackIdiom.antonyms[0];

                if (!distractors.includes(fallbackValue) && !correctAnswersForCurrent.includes(fallbackValue) && fallbackValue !== (type === 'idiom' ? currentIdiomData.idiom : currentIdiomData.meaning) ) {
                     distractors.push(fallbackValue);
                }
                fallbackAttempt++;
            }
             // Absolute fallback if everything fails
            while(distractors.length < count){
                let dummyOption = `å…¶ä»–é¸é … ${distractors.length + 1}`;
                if (!distractors.includes(dummyOption)) {
                    distractors.push(dummyOption);
                } else { // ensure uniqueness even for dummy options
                    distractors.push(`å…¶ä»–é¸é … ${Math.random().toString(36).substring(7)}`);
                }
            }
            return distractors.slice(0, count); // Ensure exactly 'count' distractors
        }


        function displayQuizQuestion() {
            clearTimeout(autoNextTimer);
            feedbackMessageEl.textContent = '';
            feedbackMessageEl.className = 'text-center font-medium mb-4';
            optionsAreaEl.innerHTML = '';
            optionsAreaEl.classList.remove('disabled-options');
            nextQuestionBtn.classList.add('hidden');
            questionBopomofoEl.textContent = '';

            if (currentQuestionDisplayIndex >= currentQuizSet.length) {
                showQuizEnd();
                return;
            }

            let actualIdiomData, questionTypeForThisTurn;
            if (activeQuizType === 'comprehensive' || activeQuizType === 'incorrectReview') {
                currentQuestionData = currentQuizSet[currentQuestionDisplayIndex];
                actualIdiomData = currentQuestionData.idiomData;
                questionTypeForThisTurn = currentQuestionData.questionType;
            } else {
                actualIdiomData = currentQuizSet[currentQuestionDisplayIndex];
                questionTypeForThisTurn = activeQuizType;
            }
            
            let questionContent, correctAnswer, optionsList;

            switch (questionTypeForThisTurn) {
                case 'idiomToMeaning':
                    questionContent = actualIdiomData.idiom;
                    questionBopomofoEl.textContent = actualIdiomData.bopomofo;
                    correctAnswer = actualIdiomData.meaning;
                    optionsList = [correctAnswer, ...getDistractorOptions(actualIdiomData, 'meaning', 3)];
                    break;
                case 'meaningToIdiom':
                    questionContent = actualIdiomData.meaning;
                    correctAnswer = actualIdiomData.idiom;
                    optionsList = [correctAnswer, ...getDistractorOptions(actualIdiomData, 'idiom', 3)];
                    break;
                case 'fillInTheBlank':
                    questionContent = actualIdiomData.sentence.replace("__BLANK__", "<span class='sentence-blank'>ï¹ã€€ã€€ï¹</span>");
                    correctAnswer = actualIdiomData.blankWord;
                    optionsList = [correctAnswer, ...getDistractorOptions(actualIdiomData, 'idiom', 3)];
                    break;
                case 'findSynonym':
                    questionContent = `ã€Œ${actualIdiomData.idiom}ã€çš„è¿‘ç¾©è©æ˜¯ï¼Ÿ`;
                    questionBopomofoEl.textContent = actualIdiomData.bopomofo;
                    // Ensure there is at least one synonym
                    if (!actualIdiomData.synonyms || actualIdiomData.synonyms.length === 0) {
                        console.error("Error: Idiom has no synonyms for findSynonym question type.", actualIdiomData);
                        currentQuestionDisplayIndex++; // Skip this question
                        displayQuizQuestion(); // Try next question
                        return;
                    }
                    correctAnswer = actualIdiomData.synonyms[Math.floor(Math.random() * actualIdiomData.synonyms.length)];
                    optionsList = [correctAnswer, ...getDistractorOptions(actualIdiomData, 'synonym', 3)];
                    break;
                case 'findAntonym':
                    questionContent = `ã€Œ${actualIdiomData.idiom}ã€çš„åç¾©è©æ˜¯ï¼Ÿ`;
                    questionBopomofoEl.textContent = actualIdiomData.bopomofo;
                     if (!actualIdiomData.antonyms || actualIdiomData.antonyms.length === 0) {
                        console.error("Error: Idiom has no antonyms for findAntonym question type.", actualIdiomData);
                        currentQuestionDisplayIndex++; 
                        displayQuizQuestion(); 
                        return;
                    }
                    correctAnswer = actualIdiomData.antonyms[Math.floor(Math.random() * actualIdiomData.antonyms.length)];
                    optionsList = [correctAnswer, ...getDistractorOptions(actualIdiomData, 'antonym', 3)];
                    break;
                default:
                    console.error("æœªçŸ¥çš„å•é¡Œé¡å‹:", questionTypeForThisTurn);
                    showModeSelection();
                    return;
            }
            
            questionTextEl.innerHTML = questionContent;
            quizProgressEl.textContent = `ç¬¬ ${currentQuestionDisplayIndex + 1} é¡Œ / å…± ${currentQuizSet.length} é¡Œ | åˆ†æ•¸: ${score}`;
            shuffleArray(optionsList);

            optionsList.forEach(optionText => {
                if (typeof optionText === 'undefined') { // Safeguard against undefined options
                    console.warn("An option was undefined for question:", questionContent, "Correct Answer:", correctAnswer, "Original Options:", optionsList);
                    return; // Skip adding this undefined option
                }
                const optionButton = document.createElement('button');
                optionButton.classList.add('btn', 'option-btn');
                optionButton.textContent = optionText;
                optionButton.addEventListener('click', () => checkQuizAnswer(optionText, correctAnswer, optionButton, actualIdiomData, questionTypeForThisTurn));
                optionsAreaEl.appendChild(optionButton);
            });
        }

        function checkQuizAnswer(selectedAnswer, correctAnswer, buttonEl, idiomData, questionType) {
            optionsAreaEl.classList.add('disabled-options');
            clearTimeout(autoNextTimer);

            if (selectedAnswer === correctAnswer) {
                feedbackMessageEl.textContent = 'ç­”å°äº†ï¼ ğŸ‰';
                feedbackMessageEl.className = 'text-center font-medium mb-4 text-green-600';
                buttonEl.classList.add('correct');
                score++;
                if (activeQuizType === 'incorrectReview') {
                    removeCorrectlyAnsweredFromIncorrectList(idiomData, questionType);
                }
                autoNextTimer = setTimeout(() => {
                    currentQuestionDisplayIndex++;
                    displayQuizQuestion();
                }, 5000);
            } else {
                feedbackMessageEl.textContent = 'ç­”éŒ¯äº†... ğŸ˜¢';
                feedbackMessageEl.className = 'text-center font-medium mb-4 text-red-600';
                buttonEl.classList.add('incorrect');
                Array.from(optionsAreaEl.children).forEach(btn => {
                    if (btn.textContent === correctAnswer) {
                        btn.classList.add('correct');
                    }
                });
                if (activeQuizType !== 'incorrectReview') {
                    addIncorrectIdiom(idiomData, questionType);
                }
            }
            nextQuestionBtn.classList.remove('hidden');
        }
        
        nextQuestionBtn.addEventListener('click', () => {
            clearTimeout(autoNextTimer);
            currentQuestionDisplayIndex++;
            displayQuizQuestion();
        });

        function showQuizEnd() {
            questionTextEl.textContent = `æ¸¬é©—çµæŸï¼æ‚¨çš„å¾—åˆ†æ˜¯ ${score} / ${currentQuizSet.length}`;
            questionBopomofoEl.textContent = '';
            optionsAreaEl.innerHTML = '';
            feedbackMessageEl.textContent = (score === currentQuizSet.length && currentQuizSet.length > 0) ? 'å¤ªæ£’äº†ï¼Œå…¨éƒ¨ç­”å°ï¼ğŸ¥³' : 'å†æ¥å†å²ï¼ğŸ’ª';
            nextQuestionBtn.classList.add('hidden');
            quizProgressEl.textContent = `æ¸¬é©—å®Œæˆ | æœ€çµ‚åˆ†æ•¸: ${score}`;
            updateIncorrectReviewButton();
        }

        function initQuizMode(type) {
            modeSelectionDiv.classList.add('hidden');
            quizModeDiv.classList.remove('hidden');
            activeQuizType = type;
            score = 0;
            currentQuestionDisplayIndex = 0;
            currentQuizSet = [];
            let quizTitleText = "";

            if (type === 'comprehensive') {
                quizTitleText = 'ç¶œåˆç·´ç¿’';
                idioms.forEach(idiom => {
                    if (idiom.meaning) currentQuizSet.push({ idiomData: idiom, questionType: 'idiomToMeaning' });
                    if (idiom.meaning) currentQuizSet.push({ idiomData: idiom, questionType: 'meaningToIdiom' });
                    if (idiom.sentence && idiom.blankWord) currentQuizSet.push({ idiomData: idiom, questionType: 'fillInTheBlank' });
                    if (idiom.synonyms && idiom.synonyms.length > 0) currentQuizSet.push({ idiomData: idiom, questionType: 'findSynonym' });
                    if (idiom.antonyms && idiom.antonyms.length > 0) currentQuizSet.push({ idiomData: idiom, questionType: 'findAntonym' });
                });
            } else if (type === 'incorrectReview') {
                quizTitleText = 'éŒ¯é¡Œç·´ç¿’';
                if (incorrectlyAnsweredIdioms.length === 0) {
                    alert("æ­å–œï¼ç›®å‰æ²’æœ‰éŒ¯é¡Œå¯ä»¥ç·´ç¿’ã€‚"); showModeSelection(); return;
                }
                currentQuizSet = [...incorrectlyAnsweredIdioms];
            } else {
                 currentQuizSet = idioms.filter(idiom => {
                    if (type === 'fillInTheBlank') return idiom.sentence && idiom.blankWord;
                    if (type === 'findSynonym') return idiom.synonyms && idiom.synonyms.length > 0;
                    if (type === 'findAntonym') return idiom.antonyms && idiom.antonyms.length > 0;
                    return true; 
                });
                if (type === 'idiomToMeaning') quizTitleText = 'çœ‹æˆèªé¸æ„æ€';
                else if (type === 'meaningToIdiom') quizTitleText = 'çœ‹æ„æ€é¸æˆèª';
                else if (type === 'fillInTheBlank') quizTitleText = 'ä¾‹å¥å¡«ç©º';
                else if (type === 'findSynonym') quizTitleText = 'æ‰¾è¿‘ç¾©è©';
                else if (type === 'findAntonym') quizTitleText = 'æ‰¾åç¾©è©';
            }
            
            if (currentQuizSet.length === 0) {
                 alert(`æŠ±æ­‰ï¼Œç›®å‰æ²’æœ‰è¶³å¤ çš„é¡Œç›®å¯ä¾›ã€Œ${quizTitleText}ã€æ¨¡å¼ç·´ç¿’ã€‚`);
                 showModeSelection();
                 return;
            }

            quizTitleEl.textContent = quizTitleText;
            shuffleArray(currentQuizSet); 
            displayQuizQuestion();
        }

        startCardModeBtn.addEventListener('click', initCardMode);
        startQuizIdiomToMeaningBtn.addEventListener('click', () => initQuizMode('idiomToMeaning'));
        startQuizMeaningToIdiomBtn.addEventListener('click', () => initQuizMode('meaningToIdiom'));
        startFillInTheBlankBtn.addEventListener('click', () => initQuizMode('fillInTheBlank'));
        startFindSynonymBtn.addEventListener('click', () => initQuizMode('findSynonym'));
        startFindAntonymBtn.addEventListener('click', () => initQuizMode('findAntonym'));
        startComprehensiveBtn.addEventListener('click', () => initQuizMode('comprehensive'));
        startIncorrectReviewBtn.addEventListener('click', () => initQuizMode('incorrectReview'));

        backToMenuFromCardBtn.addEventListener('click', showModeSelection);
        backToMenuFromQuizBtn.addEventListener('click', showModeSelection);

        showModeSelection();
    </script>
</body>
</html>
